https://pmc.ncbi.nlm.nih.gov/articles/PMC8196797/#sec4-ijms-22-05426

4.4. WGBS Data Processing
Raw sequence reads were filtered based on quality, and adapter sequences were trimmed using Trim Galore (0.4.5) [55]. Eighteen base pairs were trimmed from the 3′ ends of R1 and 5′ ends of R2 to eliminate the majority of the adaptase tails after adaptor trimming, and reads shorter than 20 bp were discarded. The trimmed reads were mapped to TAIR10 using BSMAP v2.87 [27]. The uniquely mapped reads were sorted, indexed, and divided by PCR duplicates using SAMBAMBA (v0.59) [56]. De-duplicated reads were then passed to methylation calling to assign the methylation states for each base. The alignment was evaluated using Qualimap 2.2 [57]. The cytosine methylation ratio was extracted from the mapping results using the “methratio.py” script from BSMAP with a cut-off value of 1 count. Coverage profiles were calculated from cytosine in the context of CG, CHH, and CHG. Each cytosine location was annotated using the table browser function of the UCSC genome browser (http://genome.ucsc.edu/, accessed on 19 May 2021). A methylation analysis was also performed using Bismark (v0.20.0) [28] and the trimmed reads, as described previously herein. The distribution of the methylation patterns across the gene bodies and the 2-kb upstream and downstream sequences were analyzed and plotted using deeptools [58]. The reference bed files were obtained from the UCSC genome browser Ensembl genes 44 track and LTR track under the ReMap Regulatory Atlas (http://genome.ucsc.edu/, accessed on 19 May 2021).

4.5. Differential Methylation Analysis
The publicly available wild-type Arabidopsis WGBS sequence data were obtained from SRA (https://www.ncbi.nlm.nih.gov/sra, accessed on 19 May 2021) under accession numbers SRR7586644 and SRR534177. They were quality-checked with FastQC (V0.11.8) [59] and processed using Bismark, similar to the hybrid cell line data, converted to bedgraph format using bismark2bedGraph, and used for the downstream analysis. DMRs between the hybrid cells and wild-type Arabidopsis were identified using the methylKit R [31]. The methylation differences were determined using Fisher’s exact test filtered by a minimum difference of 0.25 and q-value of 0.01. A tiling window analysis was performed with a window size of 1000 and a step size of 1000. The methylation calls were filtered by discarding the bases with coverage below 5 and bases that had more than 99.9th percentile coverage in each sample. Only bases that were present in both the control and hybrid cells were retained. The distribution of DMRs among the different chromosomes and gene regions was obtained using methylKit statistics. The DMRs were exported as bedgraphs and analyzed for repeat element enrichment via overlapping with RepeatMasker tracks on the ReMap database [32] using the BEDTools intersect too
